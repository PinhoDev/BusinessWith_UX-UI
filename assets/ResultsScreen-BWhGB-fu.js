import{q as f,j as s}from"./index-B4Oor9c_.js";import{r as p}from"./react-wGySg1uH.js";import{getAllResponses as R}from"./FirebaseServices-B90mluqh.js";import"./firebase-CBNWo9HD.js";function T({onBack:a}){const[j,x]=p.useState(!0),[d,g]=p.useState(null),[m,y]=p.useState(null);p.useEffect(()=>{h()},[]);const h=async()=>{try{x(!0);const i=(await R()).map(r=>r.answers),t=N(i);g(t),x(!1)}catch(e){console.error("Error fetching results:",e),y(e.message),x(!1)}},N=e=>{const i=f.map(t=>({id:t.id,question:t.question,options:t.options.map(r=>({id:r.id,text:r.text,count:0})),totalResponses:0}));return e.forEach(t=>{t&&Object.entries(t).forEach(([r,o])=>{const l=parseInt(r),n=i.find(c=>c.id===l);if(n){const c=n.options.find(b=>b.id===o);c&&(c.count++,n.totalResponses++)}})}),{totalSessions:e.length,questions:i}},u=(e,i)=>i>0?(e/i*100).toFixed(1):0,v=e=>{const i=Math.max(...e.map(t=>t.count));return e.filter(t=>t.count===i)};return j?s.jsx("div",{className:"container",children:s.jsxs("div",{className:"welcome-card",children:[s.jsx("div",{className:"kicker",children:"LOADING..."}),s.jsx("h2",{children:"üìä Fetching survey results..."}),s.jsx("p",{className:"subtitle",children:"Please wait a moment"})]})}):m?s.jsx("div",{className:"container",children:s.jsxs("div",{className:"welcome-card",children:[s.jsx("div",{className:"kicker",children:"ERROR"}),s.jsx("h2",{children:"‚ùå Unable to load results"}),s.jsx("p",{className:"subtitle",style:{color:"#d32f2f"},children:m}),a&&s.jsx("button",{className:"btn-primary",onClick:a,children:"‚Üê Go Back"})]})}):!d||d.totalSessions===0?s.jsx("div",{className:"container",children:s.jsxs("div",{className:"welcome-card",children:[s.jsx("div",{className:"kicker",children:"NO DATA"}),s.jsx("h2",{children:"üì≠ No responses yet"}),s.jsx("p",{className:"subtitle",children:"Be the first to complete the questionnaire!"}),a&&s.jsx("button",{className:"btn-primary",onClick:a,children:"‚Üê Go Back"})]})}):s.jsx("div",{className:"container",children:s.jsxs("div",{className:"welcome-card",children:[s.jsx("div",{className:"kicker",children:"UX RESEARCH RESULTS"}),s.jsx("h1",{children:"üìä Survey Statistics"}),s.jsxs("p",{className:"subtitle",children:["Analyzing ",s.jsx("strong",{children:d.totalSessions})," completed responses"]}),s.jsxs("div",{className:"info-box",style:{marginBottom:"32px",marginTop:"24px"},children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"icon",children:"‚úÖ"}),s.jsxs("span",{children:[d.totalSessions," Total Responses"]})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"icon",children:"üìù"}),s.jsxs("span",{children:[f.length," Questions"]})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"icon",children:"üîÑ"}),s.jsx("span",{children:"Updated in real-time"})]})]}),d.questions.map((e,i)=>{const t=v(e.options),r=[...e.options].sort((o,l)=>l.count-o.count);return s.jsxs("div",{style:{marginBottom:"40px",borderTop:"2px solid #e0e0e0",paddingTop:"24px"},children:[s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsxs("div",{className:"kicker",style:{fontSize:"12px",marginBottom:"8px"},children:["QUESTION ",i+1]}),s.jsx("h3",{style:{color:"#1976d2",marginBottom:"8px",fontSize:"18px"},children:e.question}),s.jsxs("p",{style:{fontSize:"13px",color:"#666",margin:"0 0 16px 0"},children:[e.totalResponses," responses"]})]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:r.map(o=>{const l=u(o.count,e.totalResponses),n=t.some(c=>c.id===o.id);return s.jsxs("div",{style:{background:n?"#e3f2fd":"#fafafa",border:n?"2px solid #2196f3":"1px solid #e0e0e0",borderRadius:"8px",padding:"14px 16px",position:"relative",overflow:"hidden",transition:"all 0.3s ease"},children:[s.jsx("div",{style:{position:"absolute",left:0,top:0,height:"100%",width:`${l}%`,background:n?"linear-gradient(90deg, #2196f3 0%, #64b5f6 100%)":"#e0e0e0",opacity:.15,transition:"width 0.5s ease"}}),s.jsxs("div",{style:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[s.jsx("div",{style:{flex:1},children:s.jsxs("span",{style:{fontWeight:n?"600":"normal",color:n?"#0d47a1":"#333",fontSize:"15px"},children:[n&&"üèÜ ",o.text]})}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{style:{color:"#666",fontSize:"14px",fontWeight:"500"},children:o.count}),s.jsxs("span",{style:{background:n?"#2196f3":"#9e9e9e",color:"white",padding:"2px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",minWidth:"45px",textAlign:"center"},children:[l,"%"]})]})]})]},o.id)})}),t.length===1&&s.jsxs("div",{style:{marginTop:"12px",padding:"10px 14px",background:"#f1f8e9",border:"1px solid #aed581",borderRadius:"6px",fontSize:"13px",color:"#558b2f"},children:[s.jsx("strong",{children:"‚úì Most popular:"})," ",t[0].text," (",u(t[0].count,e.totalResponses),"%)"]})]},e.id)}),s.jsxs("div",{style:{marginTop:"40px",textAlign:"center"},children:[a&&s.jsx("button",{className:"btn-primary",onClick:a,children:"‚Üê Go Back"}),s.jsx("button",{className:"btn-back",onClick:h,style:{marginLeft:"12px"},children:"üîÑ Refresh Data"})]}),s.jsx("p",{className:"disclaimer",style:{marginTop:"24px",textAlign:"center"},children:"These statistics update in real-time as new responses are submitted."})]})})}export{T as default};
